/*global define: false */define(["lodash","underscore.string","app"],function(e,t,n){"use strict";return["$scope","$log","$location","$routeParams","music","socket","tableServices",function(e,t,n,r,i,s,o){e.game.table=e.game.table||{};e.namePattern=function(){return/^[a-zA-Z0-9_-]{3,15}$/};if(r.sessionId){var u=o.getTableWithSession(r.sessionId);u.then(function(r){t.log("tableServices getTableWithSession response:",r);if(r.data.error){t.error(r.data.error);jQuery.browser.mobile?n.path("/error"):n.path("/c/error")}else e.game.table=r.data;e.$apply()},function(e){t.log("tableServices getTableWithSession error:",e)})}else{e.error={message:"Please get a valid game session!"};jQuery.browser.mobile?n.path("/error"):n.path("/c/error")}e.playerJoin=function(r){t.log(r);var i=o.joinTable(e.game.table._id,r.name,e.game.table.session);i.then(function(i){t.log("tableServices joinTable response:",i);var o={tableId:e.game.table._id,name:r.name};s.emit("game:player:join",o);n.path("/control/"+e.game.table.session+"/"+r.name);e.$apply()},function(e){t.log("tableServices joinTable error:",e)})};e.playerLeave=function(){};e.$apply()}]});